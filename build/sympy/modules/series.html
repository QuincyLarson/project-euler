

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Series Expansions &mdash; SymPy v0.7.1 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <link rel="top" title="SymPy v0.7.1 documentation" href="../index.html" />
    <link rel="up" title="SymPy Modules Reference" href="index.html" />
    <link rel="next" title="Simplify" href="simplify/simplify.html" />
    <link rel="prev" title="Term rewriting" href="rewriting.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="simplify/simplify.html" title="Simplify"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="rewriting.html" title="Term rewriting"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">SymPy v0.7.1 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">SymPy Modules Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-sympy.series">
<span id="series-expansions"></span><h1>Series Expansions<a class="headerlink" href="#module-sympy.series" title="Permalink to this headline">¶</a></h1>
<p>The series module implements series expansions as a function and many related
functions.</p>
<div class="section" id="limits">
<h2>Limits<a class="headerlink" href="#limits" title="Permalink to this headline">¶</a></h2>
<p>The main purpose of this module is the computation of limits.</p>
<dl class="function">
<dt id="sympy.series.limits.limit">
<tt class="descclassname">sympy.series.limits.</tt><tt class="descname">limit</tt><big>(</big><em>e</em>, <em>z</em>, <em>z0</em>, <em>dir='+'</em><big>)</big><a class="reference internal" href="../_modules/sympy/series/limits.html#limit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.series.limits.limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the limit of e(z) at the point z0.</p>
<p>z0 can be any expression, including oo and -oo.</p>
<p>For dir=&#8221;+&#8221; (default) it calculates the limit from the right
(z-&gt;z0+) and for dir=&#8221;-&#8221; the limit from the left (z-&gt;z0-). For infinite z0
(oo or -oo), the dir argument doesn&#8217;t matter.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">limit</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&quot;+&quot;</span><span class="p">)</span>
<span class="go">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="go">-oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Strategy:</p>
<p>First we try some heuristics for easy and frequent cases like &#8220;x&#8221;, &#8220;1/x&#8221;,
&#8220;x**2&#8221; and similar, so that it&#8217;s fast. For all other cases, we use the
Gruntz algorithm (see the gruntz() function).</p>
</dd></dl>

<p>As is explained above, the workhorse for limit computations is the
function gruntz() which implements Gruntz&#8217; algorithm for computing limits.</p>
<div class="section" id="the-gruntz-algorithm">
<h3>The Gruntz Algorithm<a class="headerlink" href="#the-gruntz-algorithm" title="Permalink to this headline">¶</a></h3>
<p>This section explains the basics of the algorithm used for computing limits.
Most of the time the limit() function should just work. However it is still
useful to keep in mind how it is implemented in case something does not work
as expected.</p>
<p>First we define an ordering on functions. Suppose <span class="math">\(f(x)\)</span> and <span class="math">\(g(x)\)</span> are two
real-valued functions such that <span class="math">\(\lim_{x \to \infty} f(x) = \infty\)</span> and
similarly <span class="math">\(\lim_{x \to \infty} g(x) = \infty\)</span>. We shall say that <span class="math">\(f(x)\)</span>
<em>dominates</em>
<span class="math">\(g(x)\)</span>, written <span class="math">\(f(x) \succ g(x)\)</span>, if for all <span class="math">\(a, b \in \mathbb{R}_{&gt;0}\)</span> we have
<span class="math">\(\lim_{x \to \infty} \frac{f(x)^a}{g(x)^b} = \infty\)</span>.
We also say that <span class="math">\(f(x)\)</span> and
<span class="math">\(g(x)\)</span> are <em>of the same comparability class</em> if neither <span class="math">\(f(x) \succ g(x)\)</span> nor
<span class="math">\(g(x) \succ f(x)\)</span> and shall denote it as <span class="math">\(f(x) \asymp g(x)\)</span>.</p>
<p>Note that whenever <span class="math">\(a, b \in \mathbb{R}_{&gt;0}\)</span> then
<span class="math">\(a f(x)^b \asymp f(x)\)</span>, and we shall use this to extend the definition of
<span class="math">\(\succ\)</span> to all functions which tend to <span class="math">\(0\)</span> or <span class="math">\(\pm \infty\)</span> as <span class="math">\(x \to \infty\)</span>.
Thus we declare that <span class="math">\(f(x) \asymp 1/f(x)\)</span> and <span class="math">\(f(x) \asymp -f(x)\)</span>.</p>
<p>It is easy to show the following examples:</p>
<ul class="simple">
<li><span class="math">\(e^x \succ x^m\)</span></li>
<li><span class="math">\(e^{x^2} \succ e^{mx}\)</span></li>
<li><span class="math">\(e^{e^x} \succ e^{x^m}\)</span></li>
<li><span class="math">\(x^m \asymp x^n\)</span></li>
<li><span class="math">\(e^{x + \frac{1}{x}} \asymp e^{x + \log{x}} \asymp e^x\)</span>.</li>
</ul>
<p>From the above definition, it is possible to prove the following property:</p>
<blockquote>
<div><p>Suppose <span class="math">\(\omega\)</span>, <span class="math">\(g_1, g_2, \dots\)</span> are functions of <span class="math">\(x\)</span>,
<span class="math">\(\lim_{x \to \infty} \omega = 0\)</span> and <span class="math">\(\omega \succ g_i\)</span> for
all <span class="math">\(i\)</span>. Let <span class="math">\(c_1, c_2, \dots \in \mathbb{R}\)</span> with <span class="math">\(c_1 &lt; c_2 &lt; \dots\)</span>.</p>
<p>Then <span class="math">\(\lim_{x \to \infty} \sum_i g_i \omega^{c_i} = \lim_{x \to \infty} g_1 \omega^{c_1}\)</span>.</p>
</div></blockquote>
<p>For <span class="math">\(g_1 = g\)</span> and <span class="math">\(\omega\)</span> as above we also have the following easy result:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(\lim_{x \to \infty} g \omega^c = 0\)</span> for <span class="math">\(c &gt; 0\)</span></li>
<li><span class="math">\(\lim_{x \to \infty} g \omega^c = \pm \infty\)</span> for <span class="math">\(c &lt; 0\)</span>,
where the sign is determined by the (eventual) sign of <span class="math">\(g\)</span></li>
<li><span class="math">\(\lim_{x \to \infty} g \omega^0 = \lim_{x \to \infty} g\)</span>.</li>
</ul>
</div></blockquote>
<p>Using these results yields the following strategy for computing
<span class="math">\(\lim_{x \to \infty} f(x)\)</span>:</p>
<ol class="arabic simple">
<li>Find the set of <em>most rapidly varying subexpressions</em> (MRV set) of <span class="math">\(f(x)\)</span>.
That is, from the set of all subexpressions of <span class="math">\(f(x)\)</span>, find the elements that
are maximal under the relation <span class="math">\(\succ\)</span>.</li>
<li>Choose a function <span class="math">\(\omega\)</span> that is in the same comparability class as
the elements in the MRV set, such that <span class="math">\(\lim_{x \to \infty} \omega = 0\)</span>.</li>
<li>Expand <span class="math">\(f(x)\)</span> as a series in <span class="math">\(\omega\)</span> in such a way that the antecedents of
the above theorem are satisfied.</li>
<li>Apply the theorem and conclude the computation of
<span class="math">\(\lim_{x \to \infty} f(x)\)</span>, possibly by recursively working on <span class="math">\(g_1(x)\)</span>.</li>
</ol>
<div class="section" id="notes">
<h4>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h4>
<p>This exposition glossed over several details. Many are described in the file
gruntz.py, and all can be found in Gruntz&#8217; very readable thesis. The most
important points that have not been explained are:</p>
<ol class="arabic simple">
<li>Given f(x) and g(x), how do we determine if <span class="math">\(f(x) \succ g(x)\)</span>,
<span class="math">\(g(x) \succ f(x)\)</span> or <span class="math">\(g(x) \asymp f(x)\)</span>?</li>
<li>How do we find the MRV set of an expression?</li>
<li>How do we compute series expansions?</li>
<li>Why does the algorithm terminate?</li>
</ol>
<p>If you are interested, be sure to take a look at
<a class="reference external" href="http://www.cybertester.com/data/gruntz.pdf">Gruntz Thesis</a>.</p>
</div>
</div>
</div>
<div class="section" id="more-intuitive-series-expansion">
<h2>More Intuitive Series Expansion<a class="headerlink" href="#more-intuitive-series-expansion" title="Permalink to this headline">¶</a></h2>
<p>This is achieved
by creating a wrapper around Basic.series(). This allows for the use of
series(x*cos(x),x), which is possibly more intuative than (x*cos(x)).series(x).</p>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">series</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">series</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
<span class="go">1 - x**2/2 + x**4/24 + O(x**6)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="order-terms">
<h2>Order Terms<a class="headerlink" href="#order-terms" title="Permalink to this headline">¶</a></h2>
<p>This module also implements automatic keeping track of the order of your
expansion.</p>
<div class="section" id="id1">
<h3>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Order</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Order</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="go">O(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Order</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">1 + O(x)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="series-acceleration">
<h2>Series Acceleration<a class="headerlink" href="#series-acceleration" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
</div>
<div class="section" id="residues">
<h2>Residues<a class="headerlink" href="#residues" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/sympylogo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Series Expansions</a><ul>
<li><a class="reference internal" href="#limits">Limits</a><ul>
<li><a class="reference internal" href="#the-gruntz-algorithm">The Gruntz Algorithm</a><ul>
<li><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#more-intuitive-series-expansion">More Intuitive Series Expansion</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#order-terms">Order Terms</a><ul>
<li><a class="reference internal" href="#id1">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#series-acceleration">Series Acceleration</a></li>
<li><a class="reference internal" href="#residues">Residues</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="rewriting.html"
                        title="previous chapter">Term rewriting</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="simplify/simplify.html"
                        title="next chapter">Simplify</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/modules/series.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="simplify/simplify.html" title="Simplify"
             >next</a> |</li>
        <li class="right" >
          <a href="rewriting.html" title="Term rewriting"
             >previous</a> |</li>
        <li><a href="../index.html">SymPy v0.7.1 documentation</a> &raquo;</li>
          <li><a href="index.html" >SymPy Modules Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008, 2009, 2010, 2011 SymPy Development Team.
      Last updated on Jul 29, 2011.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>